
        <html><head><meta charset="UTF-8"><title>Evaluator Report</title>
        <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            select, button { padding: 6px; font-size: 15px; margin-right: 10px; }
            table { border-collapse: collapse; width: 100%; margin-top: 10px; }
            th, td { border: 1px solid #ccc; padding: 6px; text-align: left; }
            th { background: #f2f2f2; }
            tr:nth-child(even) { background: #fafafa; }
            .student-block { margin-top: 40px; border: 1px solid #ddd; padding: 15px; border-radius: 6px; }
            .question-header { font-weight: bold; margin-top: 15px; font-size: 1.05em; color: #333; }
            .description { color: #555; margin-bottom: 10px; font-style: italic; }
            .passed { background-color: #e6ffe6; }
            .failed { background-color: #ffe6e6; }
            .summary { margin-top: 5px; font-weight: bold; color: #333; }

            #summaryModal {
                display: none;
                position: fixed;
                top: 10%;
                left: 50%;
                transform: translateX(-50%);
                width: 70%;
                max-height: 70vh;
                overflow-y: auto;
                background: white;
                border: 2px solid #555;
                border-radius: 8px;
                padding: 20px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                z-index: 1000;
            }
            #overlay {
                display: none;
                position: fixed;
                top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.5);
                z-index: 999;
            }
            .close-btn { float: right; cursor: pointer; color: red; font-weight: bold; }
        </style>
        <script>
            function filterReports() {
                const studentVal = document.getElementById("studentSelect").value;
                const rollVal = document.getElementById("rollSelect").value;
                const fileVal = document.getElementById("fileSelect").value;
                document.querySelectorAll(".student-block").forEach(div => {
                    const name = div.dataset.name;
                    const roll = div.dataset.roll;
                    const file = div.dataset.file;
                    const show = (
                        (studentVal === "" || name === studentVal) &&
                        (rollVal === "" || roll === rollVal) &&
                        (fileVal === "" || file === fileVal)
                    );
                    div.style.display = show ? "block" : "none";
                });
            }
            function sortStudents() {
                const sortType = document.getElementById("sortSelect").value;
                const container = document.getElementById("reportContainer");
                const blocks = Array.from(container.getElementsByClassName("student-block"));
                blocks.sort((a, b) => {
                    const scoreA = parseFloat(a.dataset.total);
                    const scoreB = parseFloat(b.dataset.total);
                    const nameA = a.dataset.name.toLowerCase();
                    const nameB = b.dataset.name.toLowerCase();
                    const rollA = a.dataset.roll.toLowerCase();
                    const rollB = b.dataset.roll.toLowerCase();
                    const fileA = a.dataset.file.toLowerCase();
                    const fileB = b.dataset.file.toLowerCase();
                    switch(sortType) {
                        case "marks": return scoreB - scoreA;
                        case "name": return nameA.localeCompare(nameB);
                        case "roll": return rollA.localeCompare(rollB);
                        case "file": return fileA.localeCompare(fileB);
                        default: return 0;
                    }
                });
                blocks.forEach(b => container.appendChild(b));
            }
            function showSummary() {
                document.getElementById("overlay").style.display = "block";
                document.getElementById("summaryModal").style.display = "block";
            }
            function closeSummary() {
                document.getElementById("overlay").style.display = "none";
                document.getElementById("summaryModal").style.display = "none";
            }
        </script>
        </head><body>
        <h2>Evaluator Report</h2>

        <label for="sortSelect">Sort By:</label>
        <select id="sortSelect" onchange="sortStudents()">
            <option value="marks">Total Marks (High → Low)</option>
            <option value="name">Student Name (A–Z)</option>
            <option value="roll">Roll Number (A–Z)</option>
            <option value="file">File Name (A–Z)</option>
        </select>

        <button onclick="showSummary()">Show Summary</button>

        <label for="studentSelect">Student:</label>
        <select id="studentSelect" onchange="filterReports()">
            <option value="">-- All Students --</option>
        <option value='ANIRUDDHAN R M'>ANIRUDDHAN R M</option><option value='Aakarsh Jawa'>Aakarsh Jawa</option><option value='Aarav Danani'>Aarav Danani</option><option value='Aradhya Mishra'>Aradhya Mishra</option><option value='Arun Murari Gottipati'>Arun Murari Gottipati</option><option value='Ashmith B Shetty'>Ashmith B Shetty</option><option value='Deshpande Rugved Shirish'>Deshpande Rugved Shirish</option><option value='Divit vats'>Divit vats</option><option value='Farhan Aziz'>Farhan Aziz</option><option value='Harsh Mittal'>Harsh Mittal</option><option value='Johann Karl'>Johann Karl</option><option value='Kanishka_Singh'>Kanishka_Singh</option><option value='Kapil Rawat'>Kapil Rawat</option><option value='Kushagra Gulati'>Kushagra Gulati</option><option value='Lalit Mohan Kumar'>Lalit Mohan Kumar</option><option value='Mayur garg'>Mayur garg</option><option value='NISHANT KUMAR'>NISHANT KUMAR</option><option value='Narane Karthic'>Narane Karthic</option><option value='Nimrat Singh'>Nimrat Singh</option><option value='Nitin Sahsani'>Nitin Sahsani</option><option value='RohanGM'>RohanGM</option><option value='S.Vaigunda Ram Singh'>S.Vaigunda Ram Singh</option><option value='Sai_Shobhith'>Sai_Shobhith</option><option value='Sarthak Chaudhary'>Sarthak Chaudhary</option><option value='Siva Samvit Vemuri'>Siva Samvit Vemuri</option><option value='Soham Uday Sahasrabudhe'>Soham Uday Sahasrabudhe</option><option value='Tejas Pandey'>Tejas Pandey</option><option value='Udit Baid'>Udit Baid</option><option value='Urvi Kamble'>Urvi Kamble</option><option value='Vaishnavi Santosh Kavishetti'>Vaishnavi Santosh Kavishetti</option><option value='Vansh Rohida'>Vansh Rohida</option><option value='aahaan chatterjee'>aahaan chatterjee</option><option value='devansh'>devansh</option><option value='devansh grover'>devansh grover</option><option value='shaurya'>shaurya</option><option value='vikram sinha'>vikram sinha</option></select>
        <label for="rollSelect">Roll:</label>
        <select id="rollSelect" onchange="filterReports()">
            <option value="">-- All Rolls --</option>
        <option value='2423343'>2423343</option><option value='2423345'>2423345</option><option value='2423346'>2423346</option><option value='2423347'>2423347</option><option value='2423348'>2423348</option><option value='2423349'>2423349</option><option value='2423350'>2423350</option><option value='2423351'>2423351</option><option value='2423352'>2423352</option><option value='2423353'>2423353</option><option value='2423354'>2423354</option><option value='2423355'>2423355</option><option value='2423356'>2423356</option><option value='2423358'>2423358</option><option value='2423359'>2423359</option><option value='2423360'>2423360</option><option value='2423361'>2423361</option><option value='2423363'>2423363</option><option value='2423364'>2423364</option><option value='2423366'>2423366</option><option value='2423370'>2423370</option><option value='2423371'>2423371</option><option value='2423372'>2423372</option><option value='2423373'>2423373</option><option value='2423374'>2423374</option><option value='2423375'>2423375</option><option value='2423376'>2423376</option><option value='2423377'>2423377</option><option value='2423378'>2423378</option><option value='2423379'>2423379</option><option value='2423380'>2423380</option><option value='2423381'>2423381</option><option value='2423382'>2423382</option><option value='2423383'>2423383</option><option value='2423384'>2423384</option></select>
        <label for="fileSelect">File:</label>
        <select id="fileSelect" onchange="filterReports()">
            <option value="">-- All Files --</option>
        <option value='2423350_Nitin.Sahsani (2).ipynb'>2423350_Nitin.Sahsani (2).ipynb</option><option value='ArunMG(2423360).ipynb'>ArunMG(2423360).ipynb</option><option value='Harsh CIA.ipynb'>Harsh CIA.ipynb</option><option value='MAYUR 2423358 (1).ipynb'>MAYUR 2423358 (1).ipynb</option><option value='Nishant_Kumar(2423349).ipynb'>Nishant_Kumar(2423349).ipynb</option><option value='Sarthak_Chaudhary_2423346.ipynb'>Sarthak_Chaudhary_2423346.ipynb</option><option value='SohamUdaySahasrabudhe2423363.ipynb'>SohamUdaySahasrabudhe2423363.ipynb</option><option value='Untitled.ipynb'>Untitled.ipynb</option><option value='Urvi Kamble.ipynb'>Urvi Kamble.ipynb</option><option value='Vaishnavi Kavishetti 2423381 (1).ipynb'>Vaishnavi Kavishetti 2423381 (1).ipynb</option><option value='VanshRohida2423372 (1).ipynb'>VanshRohida2423372 (1).ipynb</option><option value='rohan_64.ipynb'>rohan_64.ipynb</option><option value='student_notebook (1) (1).ipynb'>student_notebook (1) (1).ipynb</option><option value='student_notebook (1)(1).ipynb'>student_notebook (1)(1).ipynb</option><option value='student_notebook (1)(10).ipynb'>student_notebook (1)(10).ipynb</option><option value='student_notebook (1)(11).ipynb'>student_notebook (1)(11).ipynb</option><option value='student_notebook (1)(2).ipynb'>student_notebook (1)(2).ipynb</option><option value='student_notebook (1)(3).ipynb'>student_notebook (1)(3).ipynb</option><option value='student_notebook (1)(4).ipynb'>student_notebook (1)(4).ipynb</option><option value='student_notebook (1)(5).ipynb'>student_notebook (1)(5).ipynb</option><option value='student_notebook (1)(6).ipynb'>student_notebook (1)(6).ipynb</option><option value='student_notebook (1)(7).ipynb'>student_notebook (1)(7).ipynb</option><option value='student_notebook (1)(8).ipynb'>student_notebook (1)(8).ipynb</option><option value='student_notebook (1)(9).ipynb'>student_notebook (1)(9).ipynb</option><option value='student_notebook (1).ipynb'>student_notebook (1).ipynb</option><option value='student_notebook (1)2423377.ipynb'>student_notebook (1)2423377.ipynb</option><option value='student_notebook (2)(1).ipynb'>student_notebook (2)(1).ipynb</option><option value='student_notebook (2).ipynb'>student_notebook (2).ipynb</option><option value='student_notebook (3)(1).ipynb'>student_notebook (3)(1).ipynb</option><option value='student_notebook (3)(2).ipynb'>student_notebook (3)(2).ipynb</option><option value='student_notebook (3)(3).ipynb'>student_notebook (3)(3).ipynb</option><option value='student_notebook (3)(4).ipynb'>student_notebook (3)(4).ipynb</option><option value='student_notebook (3)(5).ipynb'>student_notebook (3)(5).ipynb</option><option value='student_notebook (3).ipynb'>student_notebook (3).ipynb</option><option value='student_notebook (4)(1).ipynb'>student_notebook (4)(1).ipynb</option><option value='student_notebook (4)(2).ipynb'>student_notebook (4)(2).ipynb</option><option value='student_notebook (4).ipynb'>student_notebook (4).ipynb</option><option value='student_notebook Nimrat Singh (3).ipynb'>student_notebook Nimrat Singh (3).ipynb</option><option value='student_notebook(1)(1).ipynb'>student_notebook(1)(1).ipynb</option><option value='student_notebook(1)(2).ipynb'>student_notebook(1)(2).ipynb</option><option value='student_notebook(1).ipynb'>student_notebook(1).ipynb</option><option value='student_notebook(2).ipynb'>student_notebook(2).ipynb</option><option value='student_notebook(3).ipynb'>student_notebook(3).ipynb</option><option value='student_notebook(4).ipynb'>student_notebook(4).ipynb</option><option value='student_notebook(5).ipynb'>student_notebook(5).ipynb</option><option value='student_notebook(6).ipynb'>student_notebook(6).ipynb</option><option value='student_notebook.ipynb'>student_notebook.ipynb</option><option value='student_notebook2423343.ipynb'>student_notebook2423343.ipynb</option><option value='student_notebook_solved.ipynb'>student_notebook_solved.ipynb</option></select><hr><div id='reportContainer'><div class="student-block" data-name="Nitin Sahsani" data-roll="2423350" data-file="2423350_Nitin.Sahsani (2).ipynb" data-total="27"><h3>Nitin Sahsani — 2423350</h3><p><strong>File:</strong> 2423350_Nitin.Sahsani (2).ipynb</p><p class='summary'>Total: 27/58 (46.55%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;Series&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;UpdatedSalary&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;UpdatedSalary&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Score&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_40&gt;&quot;, line 2, in advanced_filter_and_create
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Score&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_42&gt;&quot;, line 2, in clean_age_data
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 7316, in fillna
    value, method = validate_fillna_kwargs(value, method)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/util/_validators.py&quot;, line 293, in validate_fillna_kwargs
    raise ValueError(&quot;Must specify a fill &#x27;value&#x27; or &#x27;method&#x27;.&quot;)
ValueError: Must specify a fill &#x27;value&#x27; or &#x27;method&#x27;.
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;method&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;method&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;method&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert clean_df.shape[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_20&gt;&quot;, line 2, in fill_missing_with_mean
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 5055, in select_dtypes
    raise ValueError(&quot;at least one of include or exclude must be nonempty&quot;)
ValueError: at least one of include or exclude must be nonempty
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Team&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Team&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Team&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Team&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(age_series, pd.Series)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;tolist&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="Arun Murari Gottipati" data-roll="2423360" data-file="ArunMG(2423360).ipynb" data-total="2"><h3>Arun Murari Gottipati — 2423360</h3><p><strong>File:</strong> ArunMG(2423360).ipynb</p><p class='summary'>Total: 2/58 (3.45%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_42&gt;&quot;, line 3, in clean_age_data
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 11733, in median
    result = super().median(axis, skipna, numeric_only, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 12496, in median
    return self._stat_function(
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 12442, in _stat_function
    return self._reduce(
           ^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 11589, in _reduce
    res = df._mgr.reduce(blk_func)
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/internals/managers.py&quot;, line 1519, in reduce
    nbs = blk.reduce(func)
          ^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/internals/blocks.py&quot;, line 406, in reduce
    result = func(self.values)
             ^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 11508, in blk_func
    return op(values, axis=axis, skipna=skipna, **kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/nanops.py&quot;, line 147, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/nanops.py&quot;, line 787, in nanmedian
    raise TypeError(f&quot;Cannot convert {values} to numeric&quot;)
TypeError: Cannot convert [[&#x27;Alice&#x27; &#x27;Bob&#x27; &#x27;Charlie&#x27; &#x27;Diana&#x27; &#x27;Eve&#x27;]] to numeric
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 3, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;drop_rows_with_nan&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_20&gt;&quot;, line 3, in fill_missing_with_mean
NameError: name &#x27;NaN&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_36&gt;&quot;, line 3, in get_summary_stats
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 11720, in mean
    result = super().mean(axis, skipna, numeric_only, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 12485, in mean
    return self._stat_function(
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 12442, in _stat_function
    return self._reduce(
           ^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 11589, in _reduce
    res = df._mgr.reduce(blk_func)
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/internals/managers.py&quot;, line 1519, in reduce
    nbs = blk.reduce(func)
          ^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/internals/blocks.py&quot;, line 406, in reduce
    result = func(self.values)
             ^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 11508, in blk_func
    return op(values, axis=axis, skipna=skipna, **kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/nanops.py&quot;, line 147, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/nanops.py&quot;, line 404, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/nanops.py&quot;, line 720, in nanmean
    the_sum = _ensure_numeric(the_sum)
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/nanops.py&quot;, line 1686, in _ensure_numeric
    raise TypeError(f&quot;Could not convert {x} to numeric&quot;)
TypeError: Could not convert [&#x27;AliceBobAliceCharlie&#x27; &#x27;XYXZ&#x27;] to numeric
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_22&gt;&quot;, line 3, in group_by_mean
NameError: name &#x27;group_column&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="Harsh Mittal" data-roll="2423373" data-file="Harsh CIA.ipynb" data-total="9"><h3>Harsh Mittal — 2423373</h3><p><strong>File:</strong> Harsh CIA.ipynb</p><p class='summary'>Total: 9/58 (15.52%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;describe_numeric&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert rows == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert cols == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;select_column&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="Mayur garg" data-roll="2423358" data-file="MAYUR 2423358 (1).ipynb" data-total="29"><h3>Mayur garg — 2423358</h3><p><strong>File:</strong> MAYUR 2423358 (1).ipynb</p><p class='summary'>Total: 29/58 (50.0%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;add_updated_salary&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
NameError: name &#x27;advanced_filter_and_create&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_18&gt;&quot;, line 2, in drop_rows_with_nan
AttributeError: &#x27;function&#x27; object has no attribute &#x27;reset_index&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;fill_missing_college&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
TypeError: cannot unpack non-iterable NoneType object
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;merge_dataframes&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(age_series, pd.Series)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div></div><div class="student-block" data-name="NISHANT KUMAR" data-roll="2423349" data-file="Nishant_Kumar(2423349).ipynb" data-total="12"><h3>NISHANT KUMAR — 2423349</h3><p><strong>File:</strong> Nishant_Kumar(2423349).ipynb</p><p class='summary'>Total: 12/58 (20.69%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_16&gt;&quot;, line 2, in count_missing_values
TypeError: Series.isnull() missing 1 required positional argument: &#x27;self&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;describe_numeric&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_18&gt;&quot;, line 4, in drop_rows_with_nan
AttributeError: &#x27;function&#x27; object has no attribute &#x27;reset_index&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_30&gt;&quot;, line 2, in fill_missing_college
AttributeError: &#x27;list&#x27; object has no attribute &#x27;fillna&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_20&gt;&quot;, line 3, in fill_missing_with_mean
UnboundLocalError: cannot access local variable &#x27;fill_missing_with_mean&#x27; where it is not associated with a value
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;filter_profit_range&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;group_by_mean&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(age_series, pd.Series)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;tolist&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="Sarthak Chaudhary" data-roll="2423346" data-file="Sarthak_Chaudhary_2423346.ipynb" data-total="29"><h3>Sarthak Chaudhary — 2423346</h3><p><strong>File:</strong> Sarthak_Chaudhary_2423346.ipynb</p><p class='summary'>Total: 29/58 (50.0%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_42&gt;&quot;, line 3, in clean_age_data
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 5603, in drop
    return super().drop(
           ^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 4810, in drop
    obj = obj._drop_axis(labels, axis, level=level, errors=errors)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 4852, in _drop_axis
    new_axis = axis.drop(labels, errors=errors)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 7136, in drop
    raise KeyError(f&quot;{labels[mask].tolist()} not found in axis&quot;)
KeyError: &#x27;[True] not found in axis&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_16&gt;&quot;, line 2, in count_missing_values
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;insull&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert clean_df.shape[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;College&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;College&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;val&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;val&#x27;
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;val&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;val&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_34&gt;&quot;, line 2, in filter_profit_range
TypeError: Series.between() missing 1 required positional argument: &#x27;right&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert grouped.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;category&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;category&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_12&gt;&quot;, line 2, in select_column
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;series&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="Soham Uday Sahasrabudhe" data-roll="2423363" data-file="SohamUdaySahasrabudhe2423363.ipynb" data-total="12"><h3>Soham Uday Sahasrabudhe — 2423363</h3><p><strong>File:</strong> SohamUdaySahasrabudhe2423363.ipynb</p><p class='summary'>Total: 12/58 (20.69%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;clean_age_data&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;count_missing_values&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;describe_numeric&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_18&gt;&quot;, line 2, in drop_rows_with_nan
AttributeError: module &#x27;pandas&#x27; has no attribute &#x27;dopna&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;fill_missing_with_mean&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;group_by_mean&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;select_column&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="student name" data-roll="student roll number" data-file="Untitled.ipynb" data-total="0"><h3>student name — student roll number</h3><p><strong>File:</strong> Untitled.ipynb</p><p class='summary'>Total: 0/58 (0.0%)</p><div class="question-block" data-qname="_identity_check_"><div class="question-header">Question: _identity_check_</div><div class="description">Student did not customize name/roll_number.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[missing student identity]</td><td>failed</td><td>0</td><td>Student notebook missing personalized name/roll_number. Please define:

name = &#x27;Your Name&#x27;
roll_number = &#x27;Your Roll Number&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="Urvi Kamble" data-roll="2423383" data-file="Urvi Kamble.ipynb" data-total="9"><h3>Urvi Kamble — 2423383</h3><p><strong>File:</strong> Urvi Kamble.ipynb</p><p class='summary'>Total: 9/58 (15.52%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;count&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_30&gt;&quot;, line 2, in fill_missing_college
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_6&gt;&quot;, line 2, in get_dataframe_info
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;to_list&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_22&gt;&quot;, line 2, in group_by_mean
NameError: name &#x27;agg&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(age_series, pd.Series)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;tolist&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="Vaishnavi Santosh Kavishetti" data-roll="2423381" data-file="Vaishnavi Kavishetti 2423381 (1).ipynb" data-total="9"><h3>Vaishnavi Santosh Kavishetti — 2423381</h3><p><strong>File:</strong> Vaishnavi Kavishetti 2423381 (1).ipynb</p><p class='summary'>Total: 9/58 (15.52%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;clean_age_data&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_28&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;count_missing_values&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;count&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_30&gt;&quot;, line 3, in drop_duplicates_by_cols
NameError: name &#x27;data&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_7&gt;&quot;, line 2, in get_dataframe_info
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;to_list&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(age_series, pd.Series)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;tolist&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="Vansh Rohida" data-roll="2423372" data-file="VanshRohida2423372 (1).ipynb" data-total="16"><h3>Vansh Rohida — 2423372</h3><p><strong>File:</strong> VanshRohida2423372 (1).ipynb</p><p class='summary'>Total: 16/58 (27.59%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_16&gt;&quot;, line 2, in count_missing_values
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;insull&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_18&gt;&quot;, line 2, in drop_rows_with_nan
AttributeError: module &#x27;pandas&#x27; has no attribute &#x27;dropna&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;fill_missing_with_mean&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_12&gt;&quot;, line 2, in select_column
NameError: name &#x27;threshold&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="RohanGM" data-roll="2423364" data-file="rohan_64.ipynb" data-total="12"><h3>RohanGM — 2423364</h3><p><strong>File:</strong> rohan_64.ipynb</p><p class='summary'>Total: 12/58 (20.69%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;add_updated_salary&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;count&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_30&gt;&quot;, line 2, in fill_missing_college
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_6&gt;&quot;, line 2, in get_dataframe_info
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;to_list&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert grouped.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(age_series, pd.Series)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;tolist&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="Kanishka_Singh" data-roll="2423376" data-file="student_notebook (1) (1).ipynb" data-total="14"><h3>Kanishka_Singh — 2423376</h3><p><strong>File:</strong> student_notebook (1) (1).ipynb</p><p class='summary'>Total: 14/58 (24.14%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Age&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_42&gt;&quot;, line 2, in clean_age_data
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Age&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 3, in convert_to_datetime
NameError: name &#x27;datetime&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_16&gt;&quot;, line 3, in count_missing_values
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;insull&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;count&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: (&#x27;Name&#x27;, &#x27;Team&#x27;)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_28&gt;&quot;, line 2, in drop_duplicates_by_cols
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: (&#x27;Name&#x27;, &#x27;Team&#x27;)
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert clean_df.shape[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Unknown&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_30&gt;&quot;, line 2, in fill_missing_college
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Unknown&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_20&gt;&quot;, line 3, in fill_missing_with_mean
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 5055, in select_dtypes
    raise ValueError(&quot;at least one of include or exclude must be nonempty&quot;)
ValueError: at least one of include or exclude must be nonempty
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_14&gt;&quot;, line 3, in filter_by_threshold
TypeError: NDFrame.filter() got an unexpected keyword argument &#x27;column&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Profit&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_34&gt;&quot;, line 2, in filter_profit_range
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Profit&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: (&#x27;Age&#x27;, &#x27;Salary&#x27;)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_36&gt;&quot;, line 2, in get_summary_stats
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: (&#x27;Age&#x27;, &#x27;Salary&#x27;)
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert grouped.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;category&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;category&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;category&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;category&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(age_series, pd.Series)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;tolist&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="Johann Karl" data-roll="2423382" data-file="student_notebook (1)(1).ipynb" data-total="33"><h3>Johann Karl — 2423382</h3><p><strong>File:</strong> student_notebook (1)(1).ipynb</p><p class='summary'>Total: 33/58 (56.9%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;Series&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;UpdatedSalary&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;UpdatedSalary&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Score&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_40&gt;&quot;, line 2, in advanced_filter_and_create
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Score&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_42&gt;&quot;, line 2, in clean_age_data
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 7316, in fillna
    value, method = validate_fillna_kwargs(value, method)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/util/_validators.py&quot;, line 293, in validate_fillna_kwargs
    raise ValueError(&quot;Must specify a fill &#x27;value&#x27; or &#x27;method&#x27;.&quot;)
ValueError: Must specify a fill &#x27;value&#x27; or &#x27;method&#x27;.
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert clean_df.shape[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;fill_missing_with_mean&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_36&gt;&quot;, line 2, in get_summary_stats
NameError: name &#x27;pa&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert grouped.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Team&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Team&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Team&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Team&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(age_series, pd.Series)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;tolist&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="vikram sinha" data-roll="2423359" data-file="student_notebook (1)(10).ipynb" data-total="0"><h3>vikram sinha — 2423359</h3><p><strong>File:</strong> student_notebook (1)(10).ipynb</p><p class='summary'>Total: 0/58 (0.0%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_32&gt;&quot;, line 3, in add_updated_salary
TypeError: &#x27;DataFrame&#x27; object is not callable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;clean_age_data&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;convert_to_datetime&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;describe_numeric&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_28&gt;&quot;, line 2, in drop_duplicates_by_cols
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;drop_duplicate&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;drop_rows_with_nan&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;fill_missing_college&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;fill_missing_with_mean&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filtered.shape[0] == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;filter_profit_range&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_6&gt;&quot;, line 2, in get_dataframe_info
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;get_first_n_rows&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;get_summary_stats&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;group_by_mean&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 8, in &lt;module&gt;
  File &quot;&lt;student_cell_38&gt;&quot;, line 3, in groupby_team_agg
TypeError: &#x27;DataFrame&#x27; object is not callable
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(df, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert df.shape == (3, 3)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;merge_dataframes&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;select_column&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="student name" data-roll="student roll number" data-file="student_notebook (1)(11).ipynb" data-total="0"><h3>student name — student roll number</h3><p><strong>File:</strong> student_notebook (1)(11).ipynb</p><p class='summary'>Total: 0/58 (0.0%)</p><div class="question-block" data-qname="_identity_check_"><div class="question-header">Question: _identity_check_</div><div class="description">Student did not customize name/roll_number.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[missing student identity]</td><td>failed</td><td>0</td><td>Student notebook missing personalized name/roll_number. Please define:

name = &#x27;Your Name&#x27;
roll_number = &#x27;Your Roll Number&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="Kushagra Gulati" data-roll="2423347" data-file="student_notebook (1)(2).ipynb" data-total="33"><h3>Kushagra Gulati — 2423347</h3><p><strong>File:</strong> student_notebook (1)(2).ipynb</p><p class='summary'>Total: 33/58 (56.9%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;Series&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;UpdatedSalary&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;UpdatedSalary&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Score&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_40&gt;&quot;, line 2, in advanced_filter_and_create
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Score&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_42&gt;&quot;, line 2, in clean_age_data
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 7316, in fillna
    value, method = validate_fillna_kwargs(value, method)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/util/_validators.py&quot;, line 293, in validate_fillna_kwargs
    raise ValueError(&quot;Must specify a fill &#x27;value&#x27; or &#x27;method&#x27;.&quot;)
ValueError: Must specify a fill &#x27;value&#x27; or &#x27;method&#x27;.
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert clean_df.shape[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_20&gt;&quot;, line 2, in fill_missing_with_mean
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 5055, in select_dtypes
    raise ValueError(&quot;at least one of include or exclude must be nonempty&quot;)
ValueError: at least one of include or exclude must be nonempty
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert grouped.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Team&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Team&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Team&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Team&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(age_series, pd.Series)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;tolist&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="Udit Baid" data-roll="2423384" data-file="student_notebook (1)(3).ipynb" data-total="26"><h3>Udit Baid — 2423384</h3><p><strong>File:</strong> student_notebook (1)(3).ipynb</p><p class='summary'>Total: 26/58 (44.83%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;Series&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;UpdatedSalary&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;UpdatedSalary&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Score&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_40&gt;&quot;, line 2, in advanced_filter_and_create
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Score&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_42&gt;&quot;, line 2, in clean_age_data
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 7316, in fillna
    value, method = validate_fillna_kwargs(value, method)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/util/_validators.py&quot;, line 293, in validate_fillna_kwargs
    raise ValueError(&quot;Must specify a fill &#x27;value&#x27; or &#x27;method&#x27;.&quot;)
ValueError: Must specify a fill &#x27;value&#x27; or &#x27;method&#x27;.
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_18&gt;&quot;, line 2, in drop_rows_with_nan
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;resest_index&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>passed</td><td>1</td><td></td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_20&gt;&quot;, line 2, in fill_missing_with_mean
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 5055, in select_dtypes
    raise ValueError(&quot;at least one of include or exclude must be nonempty&quot;)
ValueError: at least one of include or exclude must be nonempty
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_34&gt;&quot;, line 2, in filter_profit_range
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;function&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;function&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;function&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert grouped.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Team&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Team&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Team&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Team&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(age_series, pd.Series)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;tolist&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="Aakarsh Jawa" data-roll="2423380" data-file="student_notebook (1)(4).ipynb" data-total="18"><h3>Aakarsh Jawa — 2423380</h3><p><strong>File:</strong> student_notebook (1)(4).ipynb</p><p class='summary'>Total: 18/58 (31.03%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_16&gt;&quot;, line 2, in count_missing_values
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;isnu11&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_18&gt;&quot;, line 2, in drop_rows_with_nan
NameError: name &#x27;true&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;fill_missing_with_mean&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_22&gt;&quot;, line 2, in group_by_mean
AttributeError: &#x27;str&#x27; object has no attribute &#x27;mean&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(age_series, pd.Series)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div></div><div class="student-block" data-name="ANIRUDDHAN R M" data-roll="2423353" data-file="student_notebook (1)(5).ipynb" data-total="13"><h3>ANIRUDDHAN R M — 2423353</h3><p><strong>File:</strong> student_notebook (1)(5).ipynb</p><p class='summary'>Total: 13/58 (22.41%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
NameError: name &#x27;advanced_filter_and_create&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
  File &quot;&lt;student_cell_4&gt;&quot;, line 2, in load_csv_string
AttributeError: &#x27;str&#x27; object has no attribute &#x27;to_dataframe&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;drop_rows_with_nan&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_20&gt;&quot;, line 2, in fill_missing_with_mean
AttributeError: &#x27;Index&#x27; object has no attribute &#x27;select_dtypes&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
  File &quot;&lt;student_cell_4&gt;&quot;, line 2, in load_csv_string
AttributeError: &#x27;str&#x27; object has no attribute &#x27;to_dataframe&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
  File &quot;&lt;student_cell_4&gt;&quot;, line 2, in load_csv_string
AttributeError: &#x27;str&#x27; object has no attribute &#x27;to_dataframe&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
  File &quot;&lt;student_cell_4&gt;&quot;, line 2, in load_csv_string
AttributeError: &#x27;str&#x27; object has no attribute &#x27;to_dataframe&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;group_by_mean&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;AvgSalary&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexing.py&quot;, line 1185, in __getitem__
    return self._getitem_tuple(key)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexing.py&quot;, line 1369, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexing.py&quot;, line 1066, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexing.py&quot;, line 1432, in _getitem_axis
    return self._get_label(key, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexing.py&quot;, line 1382, in _get_label
    return self.obj.xs(label, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 4309, in xs
    return self[key]
           ~~~~^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;AvgSalary&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;TotalProfit&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexing.py&quot;, line 1185, in __getitem__
    return self._getitem_tuple(key)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexing.py&quot;, line 1369, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexing.py&quot;, line 1066, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexing.py&quot;, line 1432, in _getitem_axis
    return self._get_label(key, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexing.py&quot;, line 1382, in _get_label
    return self.obj.xs(label, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 4309, in xs
    return self[key]
           ~~~~^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;TotalProfit&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
  File &quot;&lt;student_cell_4&gt;&quot;, line 2, in load_csv_string
AttributeError: &#x27;str&#x27; object has no attribute &#x27;to_dataframe&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
  File &quot;&lt;student_cell_4&gt;&quot;, line 2, in load_csv_string
AttributeError: &#x27;str&#x27; object has no attribute &#x27;to_dataframe&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="aahaan chatterjee" data-roll="2423354" data-file="student_notebook (1)(6).ipynb" data-total="25"><h3>aahaan chatterjee — 2423354</h3><p><strong>File:</strong> student_notebook (1)(6).ipynb</p><p class='summary'>Total: 25/58 (43.1%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;Series&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='passed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_40&gt;&quot;, line 2, in advanced_filter_and_create
TypeError: unsupported operand type(s) for &gt;&gt;: &#x27;list&#x27; and &#x27;int&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;convert_to_datetime&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_10&gt;&quot;, line 2, in describe_numeric
TypeError: NDFrame.describe() missing 1 required positional argument: &#x27;self&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert clean_df.shape[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;filter_by_threshold&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_34&gt;&quot;, line 2, in filter_profit_range
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;get_dataframe_info&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;get_first_n_rows&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert grouped.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Team&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Team&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Team&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Team&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_12&gt;&quot;, line 2, in select_column
AttributeError: module &#x27;pandas&#x27; has no attribute &#x27;series&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="Siva Samvit Vemuri" data-roll="2423348" data-file="student_notebook (1)(7).ipynb" data-total="1"><h3>Siva Samvit Vemuri — 2423348</h3><p><strong>File:</strong> student_notebook (1)(7).ipynb</p><p class='summary'>Total: 1/58 (1.72%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;add_updated_salary&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_42&gt;&quot;, line 2, in clean_age_data
NameError: name &#x27;sample_df&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;convert_to_datetime&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_16&gt;&quot;, line 2, in count_missing_values
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;insull&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
NameError: name &#x27;drop_duplicates_by_cols&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;drop_rows_with_nan&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;fill_missing_college&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_20&gt;&quot;, line 2, in fill_missing_with_mean
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 5055, in select_dtypes
    raise ValueError(&quot;at least one of include or exclude must be nonempty&quot;)
ValueError: at least one of include or exclude must be nonempty
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;filter_profit_range&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_36&gt;&quot;, line 2, in get_summary_stats
NameError: name &#x27;sample_df&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert grouped.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;category&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;category&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;category&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;category&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 8, in &lt;module&gt;
NameError: name &#x27;groupby_team_agg&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;merge_dataframes&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="Narane Karthic" data-roll="2423379" data-file="student_notebook (1)(8).ipynb" data-total="20"><h3>Narane Karthic — 2423379</h3><p><strong>File:</strong> student_notebook (1)(8).ipynb</p><p class='summary'>Total: 20/58 (34.48%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;datetime&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
</td></tr><tr class='failed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
</td></tr><tr class='failed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='failed'><td>assert &#x27;count&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
NameError: name &#x27;drop_duplicates_by_cols&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='passed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_30&gt;&quot;, line 2, in fill_missing_college
NameError: name &#x27;college&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_20&gt;&quot;, line 2, in fill_missing_with_mean
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 7316, in fillna
    value, method = validate_fillna_kwargs(value, method)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/util/_validators.py&quot;, line 293, in validate_fillna_kwargs
    raise ValueError(&quot;Must specify a fill &#x27;value&#x27; or &#x27;method&#x27;.&quot;)
ValueError: Must specify a fill &#x27;value&#x27; or &#x27;method&#x27;.
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;Name&#x27;
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;Profit&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_24&gt;&quot;, line 3, in merge_dataframes
NameError: name &#x27;df&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_12&gt;&quot;, line 2, in select_column
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;series&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="S.Vaigunda Ram Singh" data-roll="2423345" data-file="student_notebook (1)(9).ipynb" data-total="33"><h3>S.Vaigunda Ram Singh — 2423345</h3><p><strong>File:</strong> student_notebook (1)(9).ipynb</p><p class='summary'>Total: 33/58 (56.9%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;datetime&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert clean_df.shape[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;College&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;College&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;val&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;val&#x27;
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;val&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;val&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;Name&#x27;
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;Profit&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert grouped.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;category&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;category&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Team&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Team&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Team&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Team&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_12&gt;&quot;, line 2, in select_column
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;series&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="devansh grover" data-roll="2423366" data-file="student_notebook (1).ipynb" data-total="12"><h3>devansh grover — 2423366</h3><p><strong>File:</strong> student_notebook (1).ipynb</p><p class='summary'>Total: 12/58 (20.69%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;Age&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_43&gt;&quot;, line 2, in advanced_filter_and_create
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;Age&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_29&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_11&gt;&quot;, line 2, in describe_numeric
TypeError: NDFrame.describe() got an unexpected keyword argument &#x27;includes&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_31&gt;&quot;, line 2, in drop_duplicates_by_cols
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;drop_duplicate&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;drop_rows_with_nan&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_25&gt;&quot;, line 2, in group_by_mean
NameError: name &#x27;left&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;select_column&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="Farhan Aziz" data-roll="2423377" data-file="student_notebook (1)2423377.ipynb" data-total="9"><h3>Farhan Aziz — 2423377</h3><p><strong>File:</strong> student_notebook (1)2423377.ipynb</p><p class='summary'>Total: 9/58 (15.52%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
NameError: name &#x27;advanced_filter_and_create&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;clean_age_data&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_28&gt;&quot;, line 2, in drop_duplicates_by_cols
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 6840, in drop_duplicates
    result = self[-self.duplicated(subset, keep=keep)]
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 6972, in duplicated
    raise KeyError(Index(diff))
KeyError: Index([&#x27;team&#x27;], dtype=&#x27;object&#x27;)
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_18&gt;&quot;, line 2, in drop_rows_with_nan
AttributeError: &#x27;function&#x27; object has no attribute &#x27;reset_index&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_30&gt;&quot;, line 2, in fill_missing_college
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;fillna9&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;filter_profit_range&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="student name" data-roll="student roll number" data-file="student_notebook (2)(1).ipynb" data-total="0"><h3>student name — student roll number</h3><p><strong>File:</strong> student_notebook (2)(1).ipynb</p><p class='summary'>Total: 0/58 (0.0%)</p><div class="question-block" data-qname="_identity_check_"><div class="question-header">Question: _identity_check_</div><div class="description">Student did not customize name/roll_number.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[missing student identity]</td><td>failed</td><td>0</td><td>Student notebook missing personalized name/roll_number. Please define:

name = &#x27;Your Name&#x27;
roll_number = &#x27;Your Roll Number&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="Deshpande Rugved Shirish" data-roll="2423370" data-file="student_notebook (2).ipynb" data-total="26"><h3>Deshpande Rugved Shirish — 2423370</h3><p><strong>File:</strong> student_notebook (2).ipynb</p><p class='summary'>Total: 26/58 (44.83%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
NameError: name &#x27;advanced_filter_and_create&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_28&gt;&quot;, line 2, in drop_duplicates_by_cols
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 6840, in drop_duplicates
    result = self[-self.duplicated(subset, keep=keep)]
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 6972, in duplicated
    raise KeyError(Index(diff))
KeyError: Index([&#x27;team&#x27;], dtype=&#x27;object&#x27;)
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_18&gt;&quot;, line 2, in drop_rows_with_nan
AttributeError: &#x27;function&#x27; object has no attribute &#x27;reset_index&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_30&gt;&quot;, line 2, in fill_missing_college
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;fillna9&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;filter_profit_range&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert rows == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert cols == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(age_series, pd.Series)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div></div><div class="student-block" data-name="Tejas Pandey" data-roll="2423352" data-file="student_notebook (3)(1).ipynb" data-total="21"><h3>Tejas Pandey — 2423352</h3><p><strong>File:</strong> student_notebook (3)(1).ipynb</p><p class='summary'>Total: 21/58 (36.21%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;Series&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;UpdatedSalary&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;UpdatedSalary&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_18&gt;&quot;, line 2, in drop_rows_with_nan
NameError: name &#x27;true&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;fill_missing_with_mean&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_22&gt;&quot;, line 2, in group_by_mean
AttributeError: &#x27;str&#x27; object has no attribute &#x27;mean&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(age_series, pd.Series)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div></div><div class="student-block" data-name="shaurya" data-roll="2423374" data-file="student_notebook (3)(2).ipynb" data-total="13"><h3>shaurya — 2423374</h3><p><strong>File:</strong> student_notebook (3)(2).ipynb</p><p class='summary'>Total: 13/58 (22.41%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;count_missing_values&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert rows == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert cols == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;select_column&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="shaurya" data-roll="2423374" data-file="student_notebook (3)(3).ipynb" data-total="13"><h3>shaurya — 2423374</h3><p><strong>File:</strong> student_notebook (3)(3).ipynb</p><p class='summary'>Total: 13/58 (22.41%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;count_missing_values&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert rows == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert cols == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;select_column&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="shaurya" data-roll="2423374" data-file="student_notebook (3)(4).ipynb" data-total="13"><h3>shaurya — 2423374</h3><p><strong>File:</strong> student_notebook (3)(4).ipynb</p><p class='summary'>Total: 13/58 (22.41%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;count_missing_values&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert rows == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert cols == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;select_column&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="shaurya" data-roll="2423374" data-file="student_notebook (3)(5).ipynb" data-total="13"><h3>shaurya — 2423374</h3><p><strong>File:</strong> student_notebook (3)(5).ipynb</p><p class='summary'>Total: 13/58 (22.41%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;count_missing_values&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert rows == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert cols == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;select_column&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="Deshpande Rugved Shirish" data-roll="2423370" data-file="student_notebook (3).ipynb" data-total="26"><h3>Deshpande Rugved Shirish — 2423370</h3><p><strong>File:</strong> student_notebook (3).ipynb</p><p class='summary'>Total: 26/58 (44.83%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
NameError: name &#x27;advanced_filter_and_create&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_28&gt;&quot;, line 2, in drop_duplicates_by_cols
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 6840, in drop_duplicates
    result = self[-self.duplicated(subset, keep=keep)]
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 6972, in duplicated
    raise KeyError(Index(diff))
KeyError: Index([&#x27;team&#x27;], dtype=&#x27;object&#x27;)
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_18&gt;&quot;, line 2, in drop_rows_with_nan
AttributeError: &#x27;function&#x27; object has no attribute &#x27;reset_index&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_30&gt;&quot;, line 2, in fill_missing_college
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;fillna9&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;filter_profit_range&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert rows == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert cols == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(age_series, pd.Series)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div></div><div class="student-block" data-name="shaurya" data-roll="2423374" data-file="student_notebook (4)(1).ipynb" data-total="13"><h3>shaurya — 2423374</h3><p><strong>File:</strong> student_notebook (4)(1).ipynb</p><p class='summary'>Total: 13/58 (22.41%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;count_missing_values&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert rows == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert cols == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;select_column&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="Divit vats" data-roll="2423355" data-file="student_notebook (4)(2).ipynb" data-total="18"><h3>Divit vats — 2423355</h3><p><strong>File:</strong> student_notebook (4)(2).ipynb</p><p class='summary'>Total: 18/58 (31.03%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
NameError: name &#x27;advanced_filter_and_create&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;clean_age_data&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_16&gt;&quot;, line 2, in count_missing_values
AttributeError: &#x27;function&#x27; object has no attribute &#x27;sum&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_18&gt;&quot;, line 2, in drop_rows_with_nan
AttributeError: module &#x27;pandas&#x27; has no attribute &#x27;dropna&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(age_series, pd.Series)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div></div><div class="student-block" data-name="shaurya" data-roll="2423374" data-file="student_notebook (4).ipynb" data-total="13"><h3>shaurya — 2423374</h3><p><strong>File:</strong> student_notebook (4).ipynb</p><p class='summary'>Total: 13/58 (22.41%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;count_missing_values&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert rows == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert cols == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;select_column&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="Nimrat Singh" data-roll="2423361" data-file="student_notebook Nimrat Singh (3).ipynb" data-total="29"><h3>Nimrat Singh — 2423361</h3><p><strong>File:</strong> student_notebook Nimrat Singh (3).ipynb</p><p class='summary'>Total: 29/58 (50.0%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
NameError: name &#x27;advanced_filter_and_create&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_28&gt;&quot;, line 2, in drop_duplicates_by_cols
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 6840, in drop_duplicates
    result = self[-self.duplicated(subset, keep=keep)]
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 6972, in duplicated
    raise KeyError(Index(diff))
KeyError: Index([&#x27;team&#x27;], dtype=&#x27;object&#x27;)
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_18&gt;&quot;, line 2, in drop_rows_with_nan
AttributeError: &#x27;function&#x27; object has no attribute &#x27;reset_index&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_30&gt;&quot;, line 2, in fill_missing_college
TypeError: NDFrame.fillna() takes from 1 to 2 positional arguments but 3 were given
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_20&gt;&quot;, line 2, in fill_missing_with_mean
NameError: name &#x27;ret&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert rows == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert cols == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(age_series, pd.Series)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div></div><div class="student-block" data-name="Aradhya Mishra" data-roll="2423371" data-file="student_notebook(1)(1).ipynb" data-total="12"><h3>Aradhya Mishra — 2423371</h3><p><strong>File:</strong> student_notebook(1)(1).ipynb</p><p class='summary'>Total: 12/58 (20.69%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;count_missing_values&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;describe_numeric&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;drop_rows_with_nan&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;fill_missing_with_mean&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
NameError: name &#x27;get_summary_stats&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;group_by_mean&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_12&gt;&quot;, line 2, in select_column
NameError: name &#x27;threshold&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="Ashmith B Shetty" data-roll="2423378" data-file="student_notebook(1)(2).ipynb" data-total="9"><h3>Ashmith B Shetty — 2423378</h3><p><strong>File:</strong> student_notebook(1)(2).ipynb</p><p class='summary'>Total: 9/58 (15.52%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;count&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_28&gt;&quot;, line 2, in drop_duplicates_by_cols
NameError: name &#x27;drop_duplicates&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert rows == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert cols == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;select_column&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="devansh" data-roll="2423366" data-file="student_notebook(1).ipynb" data-total="13"><h3>devansh — 2423366</h3><p><strong>File:</strong> student_notebook(1).ipynb</p><p class='summary'>Total: 13/58 (22.41%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;count_missing_values&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert rows == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert cols == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;select_column&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="Tejas Pandey" data-roll="2423352" data-file="student_notebook(2).ipynb" data-total="21"><h3>Tejas Pandey — 2423352</h3><p><strong>File:</strong> student_notebook(2).ipynb</p><p class='summary'>Total: 21/58 (36.21%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;Series&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;UpdatedSalary&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/range.py&quot;, line 417, in get_loc
    raise KeyError(key)
KeyError: &#x27;UpdatedSalary&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_18&gt;&quot;, line 2, in drop_rows_with_nan
NameError: name &#x27;true&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;fill_missing_with_mean&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_22&gt;&quot;, line 2, in group_by_mean
AttributeError: &#x27;str&#x27; object has no attribute &#x27;mean&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(age_series, pd.Series)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div></div><div class="student-block" data-name="Ashmith B Shetty" data-roll="2423378" data-file="student_notebook(3).ipynb" data-total="9"><h3>Ashmith B Shetty — 2423378</h3><p><strong>File:</strong> student_notebook(3).ipynb</p><p class='summary'>Total: 9/58 (15.52%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;count&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
  File &quot;&lt;student_cell_28&gt;&quot;, line 2, in drop_duplicates_by_cols
NameError: name &#x27;drop_duplicates&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert rows == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert cols == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;select_column&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="Kapil Rawat" data-roll="2423356" data-file="student_notebook(4).ipynb" data-total="16"><h3>Kapil Rawat — 2423356</h3><p><strong>File:</strong> student_notebook(4).ipynb</p><p class='summary'>Total: 16/58 (27.59%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;count&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(age_series, pd.Series)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;tolist&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="Sai_Shobhith" data-roll="2423351" data-file="student_notebook(5).ipynb" data-total="21"><h3>Sai_Shobhith — 2423351</h3><p><strong>File:</strong> student_notebook(5).ipynb</p><p class='summary'>Total: 21/58 (36.21%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_42&gt;&quot;, line 2, in clean_age_data
NameError: name &#x27;sample_df&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;datetime&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 7, in &lt;module&gt;
NameError: name &#x27;drop_duplicates_by_cols&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert clean_df.shape[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_30&gt;&quot;, line 2, in fill_missing_college
NameError: name &#x27;sample_df&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_20&gt;&quot;, line 2, in fill_missing_with_mean
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/frame.py&quot;, line 5055, in select_dtypes
    raise ValueError(&quot;at least one of include or exclude must be nonempty&quot;)
ValueError: at least one of include or exclude must be nonempty
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_14&gt;&quot;, line 2, in filter_by_threshold
TypeError: NDFrame.filter() got an unexpected keyword argument &#x27;column&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_34&gt;&quot;, line 2, in filter_profit_range
NameError: name &#x27;sample_df&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_36&gt;&quot;, line 2, in get_summary_stats
NameError: name &#x27;sample_df&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert grouped.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;category&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;category&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;pandas/_libs/index.pyx&quot;, line 167, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/index.pyx&quot;, line 196, in pandas._libs.index.IndexEngine.get_loc
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File &quot;pandas/_libs/hashtable_class_helper.pxi&quot;, line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: &#x27;category&#x27;

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1133, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/series.py&quot;, line 1249, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/indexes/base.py&quot;, line 3819, in get_loc
    raise KeyError(key) from err
KeyError: &#x27;category&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 8, in &lt;module&gt;
  File &quot;&lt;student_cell_38&gt;&quot;, line 2, in groupby_team_agg
  File &quot;/usr/local/lib/python3.11/site-packages/pandas/core/generic.py&quot;, line 6321, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: &#x27;DataFrame&#x27; object has no attribute &#x27;group&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(age_series, pd.Series)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;tolist&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="student name" data-roll="student roll number" data-file="student_notebook(6).ipynb" data-total="0"><h3>student name — student roll number</h3><p><strong>File:</strong> student_notebook(6).ipynb</p><p class='summary'>Total: 0/58 (0.0%)</p><div class="question-block" data-qname="_identity_check_"><div class="question-header">Question: _identity_check_</div><div class="description">Student did not customize name/roll_number.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[missing student identity]</td><td>failed</td><td>0</td><td>Student notebook missing personalized name/roll_number. Please define:

name = &#x27;Your Name&#x27;
roll_number = &#x27;Your Roll Number&#x27;
</td></tr></tbody></table></div></div><div class="student-block" data-name="devansh" data-roll="2423366" data-file="student_notebook.ipynb" data-total="13"><h3>devansh — 2423366</h3><p><strong>File:</strong> student_notebook.ipynb</p><p class='summary'>Total: 13/58 (22.41%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;count_missing_values&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert clean_df.shape[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert clean_df[&#x27;x&#x27;].iloc[0] == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert clean_df[&#x27;y&#x27;].iloc[0] == 10</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert rows == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert cols == 3</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;select_column&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="Aarav Danani" data-roll="2423343" data-file="student_notebook2423343.ipynb" data-total="3"><h3>Aarav Danani — 2423343</h3><p><strong>File:</strong> student_notebook2423343.ipynb</p><p class='summary'>Total: 3/58 (5.17%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert pd.api.types.is_datetime64_any_dtype(converted[&#x27;date&#x27;])</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert converted[&#x27;date&#x27;].iloc[0].year == 2023</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert converted[&#x27;date&#x27;].iloc[0].month == 1</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert missing[&#x27;a&#x27;] == 1</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;b&#x27;] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert missing[&#x27;c&#x27;] == 0</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;drop_rows_with_nan&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;College&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;College&#x27;].tolist() == [&#x27;IIT&#x27;, &#x27;Unknown&#x27;, &#x27;NIT&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert grouped.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;merge_dataframes&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 3, in &lt;module&gt;
NameError: name &#x27;load_csv_string&#x27; is not defined
</td></tr></tbody></table></div></div><div class="student-block" data-name="Lalit Mohan Kumar" data-roll="2423375" data-file="student_notebook_solved.ipynb" data-total="21"><h3>Lalit Mohan Kumar — 2423375</h3><p><strong>File:</strong> student_notebook_solved.ipynb</p><p class='summary'>Total: 21/58 (36.21%)</p><div class="question-block" data-qname="add_updated_salary"><div class="question-header">Question: add_updated_salary</div><div class="description">Given a DataFrame df with a &#x27;Salary&#x27; column, write code to increase salary by 5% and store it in a new column &#x27;UpdatedSalary&#x27;.

**Hint:** Multiply the Salary column by 1.05 to increase by 5%.

**Choose the correct code:**
- (a) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 5`
- (b) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] * 1.05`
- (c) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;] + 0.05`
- (d) `df[&#x27;UpdatedSalary&#x27;] = df[&#x27;Salary&#x27;].apply(lambda x: x * 5)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert &#x27;UpdatedSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;UpdatedSalary&#x27;].iloc[1] == 57750</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="advanced_filter_and_create"><div class="question-header">Question: advanced_filter_and_create</div><div class="description">Given a DataFrame with columns: Name, Score1, Score2

Write Python code to:
1. Select only rows where Score1 &gt; 40 AND Score2 &gt; 50
2. Create a new column AverageScore = mean of Score1 and Score2
3. return dataframe with only the  `[[&#x27;Name&#x27;, &#x27;AverageScore&#x27;]]`
**Hint:** Filter first using boolean indexing, then add the new column, then select specific columns.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2  # Only B and C qualify</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;C&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[0] == 60  # (55+65)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result[&#x27;AverageScore&#x27;].iloc[1] == 72.5  # (70+75)/2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="clean_age_data"><div class="question-header">Question: clean_age_data</div><div class="description">You have a DataFrame with an &#x27;Age&#x27; column containing missing values and outliers (Age &gt; 100).

Write Python code to:
1. Replace missing values with the median age
2. Remove rows where Age &gt; 100
3. Return the cleaned DataFrame

**Hint:** Use `.fillna()` with median, then filter with boolean indexing.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result[&#x27;Age&#x27;].isnull().sum() == 0  # No missing values</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert (result[&#x27;Age&#x27;] &lt;= 100).all()  # No outliers</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert result.shape[0] == 4  # Charlie (105) removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Diana&#x27;, &#x27;Eve&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="convert_to_datetime"><div class="question-header">Question: convert_to_datetime</div><div class="description">**Return:** A DataFrame where the specified column has been converted to datetime

**Choose the correct code:**
- (a) `df_copy[col_name] = df_copy[col_name].astype(datetime)`
- (b) `df_copy[col_name] = pd.to_datetime(df_copy[col_name])`
- (c) `df_copy[col_name].convert_to_datetime()`
- (d) `df_copy[col_name] = datetime.strptime(df_copy[col_name], &#x27;%Y-%m-%d&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_26&gt;&quot;, line 2, in convert_to_datetime
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="count_missing_values"><div class="question-header">Question: count_missing_values</div><div class="description">**Return:** A pandas Series with column names as index and count of NaN as values

**Hint:** Use `.isnull().sum()` to count missing values in each column.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
NameError: name &#x27;count_missing_values&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="describe_numeric"><div class="question-header">Question: describe_numeric</div><div class="description">**Return:** A pandas DataFrame with descriptive statistics (using .describe())</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(stats, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;count&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;mean&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert &#x27;std&#x27; in stats.index</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="drop_duplicates_by_cols"><div class="question-header">Question: drop_duplicates_by_cols</div><div class="description">You have a DataFrame with duplicate rows. The command `drop_duplicates` on subset of columns named `[&#x27;Name&#x27;, &#x27;Team&#x27;]` is to be used.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 3  # One duplicate removed</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;Alice&#x27;, &#x27;Bob&#x27;, &#x27;Charlie&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="drop_rows_with_nan"><div class="question-header">Question: drop_rows_with_nan</div><div class="description">**Return:** A DataFrame with all rows containing NaN removed

**Hint:** Use `.dropna()` to remove rows with missing values, then `.reset_index(drop=True)` to renumber rows.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;&lt;student_cell_18&gt;&quot;, line 2, in drop_rows_with_nan
AttributeError: module &#x27;pandas&#x27; has no attribute &#x27;dropna&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_college"><div class="question-header">Question: fill_missing_college</div><div class="description">Write a Python command to fill all missing values in the column &#x27;College&#x27; with the text &#x27;Unknown&#x27;.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>[context setup]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 26, in run_assertions
    exec(compile(context_code, &quot;&lt;context_code&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;context_code&gt;&quot;, line 6, in &lt;module&gt;
  File &quot;&lt;student_cell_30&gt;&quot;, line 2, in fill_missing_college
NameError: name &#x27;df_copy&#x27; is not defined
</td></tr></tbody></table></div><div class="question-block" data-qname="fill_missing_with_mean"><div class="question-header">Question: fill_missing_with_mean</div><div class="description">**Return:** A DataFrame where NaN values in numeric columns are replaced by column mean

**Hint:** Get numeric columns using `.select_dtypes()`, then use `.fillna()` with the column mean.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert filled[&#x27;val&#x27;].isnull().sum() == 0</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert filled[&#x27;val&#x27;].iloc[2] == 20</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="filter_by_threshold"><div class="question-header">Question: filter_by_threshold</div><div class="description">**Return:** A DataFrame containing only rows where column &gt; threshold

**Hint:** Use boolean indexing `df[df[col_name] &gt; threshold]` and `.reset_index(drop=True)` to reset row indices.

**Choose the correct code:**
- (a) `return df.filter(column=col_name, value=threshold)`
- (b) `return df.loc[df[col_name] &gt; threshold]`
- (c) `return df[df[col_name] &gt; threshold].reset_index(drop=True)`
- (d) `return df.query(f&#x27;{col_name} &gt; {threshold}&#x27;)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert filtered.shape[0] == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert filtered[&#x27;score&#x27;].min() &gt; 80</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="filter_profit_range"><div class="question-header">Question: filter_profit_range</div><div class="description">Write Python code to select rows where &#x27;Profit&#x27; is between 30 and 55 (inclusive).

**Hint:** Use boolean indexing with AND operator `&amp;`.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert list(result[&#x27;Name&#x27;]) == [&#x27;B&#x27;, &#x27;D&#x27;]</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr><tr class='failed'><td>assert all((result[&#x27;Profit&#x27;] &gt;= 30) &amp; (result[&#x27;Profit&#x27;] &lt;= 55))</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#x27;NoneType&#x27; object is not subscriptable
</td></tr></tbody></table></div><div class="question-block" data-qname="get_dataframe_info"><div class="question-header">Question: get_dataframe_info</div><div class="description">**Return:** A tuple of (number of rows, number of columns, list of column names)

**Choose the correct code:**
- (a) `return (df.size, df.ndim, df.columns)`
- (b) `return (df.shape[0], df.shape[1], list(df.columns))`
- (c) `return df.info()`
- (d) `return (len(df), len(df.index), df.to_list())`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert rows == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert cols == 3</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert columns == [&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_first_n_rows"><div class="question-header">Question: get_first_n_rows</div><div class="description">**Return:** DataFrame containing first n rows

**Choose the correct code:**
- (a) `return df.iloc[:n]`
- (b) `return df.head(n)`
- (c) `return df.nlargest(n, axis=0)`
- (d) `return df[:n:1]`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert first_two.shape == (2, 2)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert first_two[&#x27;a&#x27;].tolist() == [1, 2]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="get_summary_stats"><div class="question-header">Question: get_summary_stats</div><div class="description">Write a Python command to show summary statistics (mean, median, std, min, max, etc.) for the entire DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert isinstance(stats, pd.DataFrame)</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AssertionError
</td></tr><tr class='failed'><td>assert &#x27;mean&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert &#x27;std&#x27; in stats.index</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;index&#x27;
</td></tr><tr class='failed'><td>assert stats.loc[&#x27;count&#x27;, &#x27;Age&#x27;] == 4</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="group_by_mean"><div class="question-header">Question: group_by_mean</div><div class="description">**Return:** A DataFrame with grouped results (group column and mean)

**Hint:** Use `.groupby(group_col)[agg_col].mean()` and `.reset_index()` to convert to DataFrame.</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert grouped.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;A&#x27;, &#x27;value&#x27;].iloc[0] == 20</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert grouped.loc[grouped[&#x27;category&#x27;] == &#x27;B&#x27;, &#x27;value&#x27;].iloc[0] == 30</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="groupby_team_agg"><div class="question-header">Question: groupby_team_agg</div><div class="description">You have a DataFrame with columns: Name, Team, Salary, Profit

Write Python code to:
1. Group the data by Team
2. aggregate average salary and total profit for each team
3. return the result

**Hint:** Use `.groupby()` with `.agg()` for multiple aggregations.

**Choose the correct code:**
- (a) `df.groupby(&#x27;Team&#x27;).agg({&#x27;Salary&#x27;: &#x27;mean&#x27;, &#x27;Profit&#x27;: &#x27;sum&#x27;})`
- (b) `df.groupby(&#x27;Team&#x27;)[[&#x27;Salary&#x27;, &#x27;Profit&#x27;]].agg([&#x27;mean&#x27;, &#x27;sum&#x27;])`
- (c) `df.group(&#x27;Team&#x27;).apply(lambda x: {&#x27;avg_salary&#x27;: x[&#x27;Salary&#x27;].mean(), &#x27;total_profit&#x27;: x[&#x27;Profit&#x27;].sum()})`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='failed'><td>assert result.shape[0] == 2</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;shape&#x27;
</td></tr><tr class='failed'><td>assert &#x27;AvgSalary&#x27; in result.columns</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;columns&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;AvgSalary&#x27;].iloc[0] == 52500</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr><tr class='failed'><td>assert result.loc[result[&#x27;Team&#x27;] == &#x27;X&#x27;, &#x27;TotalProfit&#x27;].iloc[0] == 75</td><td>failed</td><td>0</td><td>Traceback (most recent call last):
  File &quot;/app/src/instantgrade/comparison/comparison_service.py&quot;, line 44, in run_assertions
    exec(compile(code, &quot;&lt;assertion&gt;&quot;, &quot;exec&quot;), ns)
  File &quot;&lt;assertion&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: &#x27;NoneType&#x27; object has no attribute &#x27;loc&#x27;
</td></tr></tbody></table></div><div class="question-block" data-qname="load_csv_string"><div class="question-header">Question: load_csv_string</div><div class="description">**Return:** A pandas DataFrame from the CSV string

**Choose the correct line:**
- (a) `return pd.read_excel(StringIO(csv_string))`
- (b) `return pd.read_csv(StringIO(csv_string))`
- (c) `return pd.DataFrame(csv_string.split(&#x27;\n&#x27;))`
- (d) `return csv_string.to_dataframe()`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(df, pd.DataFrame)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert list(df.columns) == [&#x27;name&#x27;, &#x27;age&#x27;, &#x27;score&#x27;]</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert df.shape == (3, 3)</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="merge_dataframes"><div class="question-header">Question: merge_dataframes</div><div class="description">**Return:** A merged DataFrame (inner join on the specified key)

**Choose the correct code:**
- (a) `return left.join(right, on=on)`
- (b) `return pd.concat([left, right])`
- (c) `return pd.merge(left, right, on=on, how=&#x27;inner&#x27;)`
- (d) `return left.combine(right)`</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert merged.shape[0] == 2</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert set(merged.columns) == {&#x27;id&#x27;, &#x27;value_left&#x27;, &#x27;value_right&#x27;}</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div><div class="question-block" data-qname="select_column"><div class="question-header">Question: select_column</div><div class="description">**Return:** A pandas Series for the specified column</div><table><thead><tr><th>Assertion</th><th>Status</th><th>Score</th><th>Error</th></tr></thead><tbody><tr class='passed'><td>assert isinstance(age_series, pd.Series)</td><td>passed</td><td>1</td><td></td></tr><tr class='passed'><td>assert age_series.tolist() == [25, 30, 22]</td><td>passed</td><td>1</td><td></td></tr></tbody></table></div></div>
        </div><div id="overlay" onclick="closeSummary()"></div>
        <div id="summaryModal">
            <span class="close-btn" onclick="closeSummary()">✖</span>
            <h3>Student Summary</h3>
            <table>
                <thead><tr>
                  <th>Student</th><th>Roll Number</th><th>File</th>
                  <th>Total Marks</th><th>Out Of</th><th>Percentage</th>
                </tr></thead><tbody>
        <tr><td>Nitin Sahsani</td><td>2423350</td><td>2423350_Nitin.Sahsani (2).ipynb</td><td>27</td><td>58</td><td>46.55%</td></tr><tr><td>Arun Murari Gottipati</td><td>2423360</td><td>ArunMG(2423360).ipynb</td><td>2</td><td>58</td><td>3.45%</td></tr><tr><td>Harsh Mittal</td><td>2423373</td><td>Harsh CIA.ipynb</td><td>9</td><td>58</td><td>15.52%</td></tr><tr><td>Mayur garg</td><td>2423358</td><td>MAYUR 2423358 (1).ipynb</td><td>29</td><td>58</td><td>50.0%</td></tr><tr><td>NISHANT KUMAR</td><td>2423349</td><td>Nishant_Kumar(2423349).ipynb</td><td>12</td><td>58</td><td>20.69%</td></tr><tr><td>Sarthak Chaudhary</td><td>2423346</td><td>Sarthak_Chaudhary_2423346.ipynb</td><td>29</td><td>58</td><td>50.0%</td></tr><tr><td>Soham Uday Sahasrabudhe</td><td>2423363</td><td>SohamUdaySahasrabudhe2423363.ipynb</td><td>12</td><td>58</td><td>20.69%</td></tr><tr><td>Urvi Kamble</td><td>2423383</td><td>Urvi Kamble.ipynb</td><td>9</td><td>58</td><td>15.52%</td></tr><tr><td>Vaishnavi Santosh Kavishetti</td><td>2423381</td><td>Vaishnavi Kavishetti 2423381 (1).ipynb</td><td>9</td><td>58</td><td>15.52%</td></tr><tr><td>Vansh Rohida</td><td>2423372</td><td>VanshRohida2423372 (1).ipynb</td><td>16</td><td>58</td><td>27.59%</td></tr><tr><td>RohanGM</td><td>2423364</td><td>rohan_64.ipynb</td><td>12</td><td>58</td><td>20.69%</td></tr><tr><td>Kanishka_Singh</td><td>2423376</td><td>student_notebook (1) (1).ipynb</td><td>14</td><td>58</td><td>24.14%</td></tr><tr><td>Johann Karl</td><td>2423382</td><td>student_notebook (1)(1).ipynb</td><td>33</td><td>58</td><td>56.9%</td></tr><tr><td>vikram sinha</td><td>2423359</td><td>student_notebook (1)(10).ipynb</td><td>0</td><td>58</td><td>0.0%</td></tr><tr><td>Kushagra Gulati</td><td>2423347</td><td>student_notebook (1)(2).ipynb</td><td>33</td><td>58</td><td>56.9%</td></tr><tr><td>Udit Baid</td><td>2423384</td><td>student_notebook (1)(3).ipynb</td><td>26</td><td>58</td><td>44.83%</td></tr><tr><td>Aakarsh Jawa</td><td>2423380</td><td>student_notebook (1)(4).ipynb</td><td>18</td><td>58</td><td>31.03%</td></tr><tr><td>ANIRUDDHAN R M</td><td>2423353</td><td>student_notebook (1)(5).ipynb</td><td>13</td><td>58</td><td>22.41%</td></tr><tr><td>aahaan chatterjee</td><td>2423354</td><td>student_notebook (1)(6).ipynb</td><td>25</td><td>58</td><td>43.1%</td></tr><tr><td>Siva Samvit Vemuri</td><td>2423348</td><td>student_notebook (1)(7).ipynb</td><td>1</td><td>58</td><td>1.72%</td></tr><tr><td>Narane Karthic</td><td>2423379</td><td>student_notebook (1)(8).ipynb</td><td>20</td><td>58</td><td>34.48%</td></tr><tr><td>S.Vaigunda Ram Singh</td><td>2423345</td><td>student_notebook (1)(9).ipynb</td><td>33</td><td>58</td><td>56.9%</td></tr><tr><td>devansh grover</td><td>2423366</td><td>student_notebook (1).ipynb</td><td>12</td><td>58</td><td>20.69%</td></tr><tr><td>Farhan Aziz</td><td>2423377</td><td>student_notebook (1)2423377.ipynb</td><td>9</td><td>58</td><td>15.52%</td></tr><tr><td>Deshpande Rugved Shirish</td><td>2423370</td><td>student_notebook (2).ipynb</td><td>26</td><td>58</td><td>44.83%</td></tr><tr><td>Tejas Pandey</td><td>2423352</td><td>student_notebook (3)(1).ipynb</td><td>21</td><td>58</td><td>36.21%</td></tr><tr><td>shaurya</td><td>2423374</td><td>student_notebook (3)(2).ipynb</td><td>13</td><td>58</td><td>22.41%</td></tr><tr><td>shaurya</td><td>2423374</td><td>student_notebook (3)(3).ipynb</td><td>13</td><td>58</td><td>22.41%</td></tr><tr><td>shaurya</td><td>2423374</td><td>student_notebook (3)(4).ipynb</td><td>13</td><td>58</td><td>22.41%</td></tr><tr><td>shaurya</td><td>2423374</td><td>student_notebook (3)(5).ipynb</td><td>13</td><td>58</td><td>22.41%</td></tr><tr><td>Deshpande Rugved Shirish</td><td>2423370</td><td>student_notebook (3).ipynb</td><td>26</td><td>58</td><td>44.83%</td></tr><tr><td>shaurya</td><td>2423374</td><td>student_notebook (4)(1).ipynb</td><td>13</td><td>58</td><td>22.41%</td></tr><tr><td>Divit vats</td><td>2423355</td><td>student_notebook (4)(2).ipynb</td><td>18</td><td>58</td><td>31.03%</td></tr><tr><td>shaurya</td><td>2423374</td><td>student_notebook (4).ipynb</td><td>13</td><td>58</td><td>22.41%</td></tr><tr><td>Nimrat Singh</td><td>2423361</td><td>student_notebook Nimrat Singh (3).ipynb</td><td>29</td><td>58</td><td>50.0%</td></tr><tr><td>Aradhya Mishra</td><td>2423371</td><td>student_notebook(1)(1).ipynb</td><td>12</td><td>58</td><td>20.69%</td></tr><tr><td>Ashmith B Shetty</td><td>2423378</td><td>student_notebook(1)(2).ipynb</td><td>9</td><td>58</td><td>15.52%</td></tr><tr><td>devansh</td><td>2423366</td><td>student_notebook(1).ipynb</td><td>13</td><td>58</td><td>22.41%</td></tr><tr><td>Tejas Pandey</td><td>2423352</td><td>student_notebook(2).ipynb</td><td>21</td><td>58</td><td>36.21%</td></tr><tr><td>Ashmith B Shetty</td><td>2423378</td><td>student_notebook(3).ipynb</td><td>9</td><td>58</td><td>15.52%</td></tr><tr><td>Kapil Rawat</td><td>2423356</td><td>student_notebook(4).ipynb</td><td>16</td><td>58</td><td>27.59%</td></tr><tr><td>Sai_Shobhith</td><td>2423351</td><td>student_notebook(5).ipynb</td><td>21</td><td>58</td><td>36.21%</td></tr><tr><td>devansh</td><td>2423366</td><td>student_notebook.ipynb</td><td>13</td><td>58</td><td>22.41%</td></tr><tr><td>Aarav Danani</td><td>2423343</td><td>student_notebook2423343.ipynb</td><td>3</td><td>58</td><td>5.17%</td></tr><tr><td>Lalit Mohan Kumar</td><td>2423375</td><td>student_notebook_solved.ipynb</td><td>21</td><td>58</td><td>36.21%</td></tr></tbody></table></div></body></html>